# CreditPilot 完整设置与运行时注意事项

**项目**：CreditPilot 信用卡账单管理系统  
**部署平台**：Railway  
**最后更新**：2025-12-10

---

## 📋 目录

1. [初始设置](#初始设置)
2. [Railway 配置](#railway-配置)
3. [环境变量配置](#环境变量配置)
4. [运行时注意事项](#运行时注意事项)
5. [维护和监控](#维护和监控)
6. [安全注意事项](#安全注意事项)
7. [性能优化](#性能优化)
8. [故障排查](#故障排查)
9. [备份和恢复](#备份和恢复)
10. [常见问题](#常见问题)

---

## 一、初始设置

### 1.1 代码准备

#### 必需文件检查
- [ ] `Dockerfile` 存在于根目录
- [ ] `backend/start.sh` 存在且可执行
- [ ] `backend/main.py` 存在
- [ ] `backend/models.py` 存在
- [ ] `backend/init_db.py` 存在
- [ ] `backend/reminder_system.py` 存在
- [ ] `backend/email_service.py` 存在
- [ ] `backend/requirements.txt` 存在

#### 代码路径检查
- [ ] 上传目录：代码中使用 `/app/uploads`
- [ ] 报告目录：代码中使用 `/app/reports`
- [ ] 端口配置：使用环境变量 `PORT` 或默认 `8000`
- [ ] 数据库连接：使用 `DATABASE_URL` 环境变量

#### 依赖检查
- [ ] `backend/requirements.txt` 包含所有必需依赖
- [ ] PostgreSQL 驱动：`psycopg2-binary`
- [ ] 所有依赖都有版本号（推荐）

---

### 1.2 GitHub 仓库准备

#### 仓库设置
- [ ] 仓库名称：`credit-pilot-cursor`（或你的实际名称）
- [ ] 仓库是公开的或 Railway 有访问权限
- [ ] 主分支是 `main`（或 `master`）

#### 代码推送
- [ ] 所有代码已推送到 GitHub
- [ ] 最新修复已推送（PostgreSQL 连接、错误处理等）
- [ ] `.env` 文件**不要**推送到 GitHub（应在 `.gitignore` 中）

---

## 二、Railway 配置

### 2.1 项目创建

#### 创建 Railway 项目
- [ ] 登录 Railway 账户
- [ ] 创建新项目或使用现有项目
- [ ] 项目名称：`CreditPilot`（或你的实际名称）

---

### 2.2 Postgres 服务配置

#### 创建 Postgres 服务
- [ ] 在项目主页，点击 **"+Create"**
- [ ] 选择 **"DATABASE"** → **"PostgreSQL"**
- [ ] Railway 自动创建并配置

#### Variables 检查（自动生成）
进入 Postgres 服务 → **Variables**

**Railway 自动生成的变量**（**不要修改**）：
- [ ] `DATABASE_URL` 存在
- [ ] `DATABASE_PUBLIC_URL` 存在
- [ ] `PGHOST` 存在
- [ ] `PGPORT` 存在
- [ ] `PGUSER` 存在
- [ ] `PGPASSWORD` 存在
- [ ] `PGDATABASE` 存在

**⚠️ 重要**：这些变量都是自动生成的，**保持原样，不要修改**！

#### Settings 检查
进入 Postgres 服务 → **Settings**

- [ ] **Custom Start Command**：**留空** ✅
- [ ] **Cron Schedule**：**留空** ✅
- [ ] **Volume**：**不需要** ✅

**⚠️ 重要**：数据库只作为被动服务使用，不要配置 Cron、Volume 或自定义 Start Command。

---

### 2.3 Web 服务配置

#### 创建 Web 服务
- [ ] 在项目主页，点击 **"+Create"**
- [ ] 选择 **"GITHUB REPO"**
- [ ] 选择仓库：`zee14913913/credit-pilot-cursor`
- [ ] 点击 **"Deploy"**

#### Build 设置
进入 Web 服务 → **Settings** → **Build**

- [ ] **Builder**：选择 **"Dockerfile"**
- [ ] **Dockerfile Path**：填写 `Dockerfile`
  - 也可以填写 `/Dockerfile`（Railway 会当作根路径）
- [ ] **Metal Build Environment**：可以开启 ✅（推荐，更快）

#### Deploy 设置
进入 Web 服务 → **Settings** → **Deploy**

- [ ] **Custom Start Command**：**留空** ✅
  - 使用 Dockerfile 的 CMD：`["bash", "start.sh"]`
- [ ] **Cron Schedule**：**留空** ✅
  - 如果使用方案B，Cron 在单独服务中配置

#### Networking 设置
进入 Web 服务 → **Settings** → **Networking**

- [ ] 点击 **"Edit Port"**
- [ ] 输入：`8000`
- [ ] 保存

**确认**：你的应用在容器内部监听 `8000` 端口
- 代码中：`uvicorn main:app --host 0.0.0.0 --port 8000`
- 或：`port = int(os.getenv("PORT", 8000))`

#### Variables 设置（最关键）

进入 Web 服务 → **Variables**

##### DATABASE_URL（最重要）⚠️

**操作步骤**：
1. 点击 **"New Variable"** 或查找现有 `DATABASE_URL`
2. **Name**：`DATABASE_URL`
3. **Value**：`${{ Postgres.DATABASE_URL }}`
   - ⚠️ **格式**：双大括号 `{{ }}`，有空格
   - ⚠️ **Postgres**：这是你的数据库服务名称（如果不同，请替换）
   - Railway UI 会自动显示下拉提示，列出可用的服务名称
4. 点击 **"Add"** 或 **"Save"**

**⚠️ 常见错误**：
- ❌ `${Postgres.DATABASE_URL}`（单大括号）
- ❌ `${{Postgres.DATABASE_URL}}`（没有空格）
- ❌ 手动写死的连接字符串（如 `postgresql://user:pass@host/db`）

**✅ 正确格式**：`${{ Postgres.DATABASE_URL }}`

##### 其他必需变量

点击 **"New Variable"**，逐个添加：

| Name | Value | 必需 | 说明 |
|------|-------|------|------|
| `DATABASE_URL` | `${{ Postgres.DATABASE_URL }}` | ✅ | 数据库连接（最重要） |
| `SENDER_EMAIL` | `business@infinite-gz.com` | ✅ | 发件人邮箱 |
| `SENDER_PASSWORD` | `grqcgnrwqhbeocox` | ✅ | Gmail 应用密码 |
| `RECIPIENT_EMAIL` | `wang041396@gmail.com` | ✅ | 收件人邮箱 |
| `SMTP_SERVER` | `smtp.gmail.com` | ✅ | SMTP 服务器 |
| `SMTP_PORT` | `587` | ✅ | SMTP 端口 |
| `UPLOAD_DIR` | `/app/uploads` | ✅ | 上传目录 |
| `REPORTS_DIR` | `/app/reports` | ✅ | 报告目录 |

**⚠️ 注意事项**：
- `SENDER_PASSWORD` 必须是 Gmail 应用密码，不是普通密码
- 所有路径变量必须与 Volume Mount Path 一致
- 变量名称区分大小写

#### Volume 挂载

##### 创建 Volume（项目级别）

**⚠️ 重要**：在**项目主页**创建，不是服务页面！

1. 在 Railway **项目主页**（不是服务页面），点击右上角 **"+Create"**
2. 选择 **"VOLUME"**
3. 创建第一个 Volume：
   - **Name**：`uploads`
   - **Mount Path**：`/app/uploads`
   - 点击 **"Add"** 或 **"Create"**
4. 创建第二个 Volume：
   - **Name**：`reports`
   - **Mount Path**：`/app/reports`
   - 点击 **"Add"** 或 **"Create"**

##### 附加 Volume 到 Web 服务

1. 进入 **Web 服务** → **Settings** → **Volumes**
2. 点击 **"Attach Volume"** 或 **"Add Volume"**
3. 选择 `uploads` Volume
4. 确认 **Mount Path** 是 `/app/uploads`
5. 点击 **"Attach"**
6. 重复步骤，附加 `reports` Volume：
   - 选择 `reports` Volume
   - 确认 **Mount Path** 是 `/app/reports`

**⚠️ 注意事项**：
- Volume 必须在项目级别创建
- Mount Path 必须与代码中的路径一致
- 如果路径不一致，文件会找不到

---

### 2.4 Reminder-Cron 服务配置（方案B - 推荐）

#### 创建 Reminder-Cron 服务

1. 在 Railway 项目主页，点击 **"+Create"**
2. 选择 **"GITHUB REPO"**
3. 选择仓库：`zee14913913/credit-pilot-cursor`（与 Web 服务相同）
4. 点击 **"Deploy"**

#### 重命名服务

1. 点击新创建的服务
2. 进入 **Settings**
3. 找到 **"Service Name"** 或类似选项
4. 改为：`reminder-cron`
5. 保存

#### Build 设置

进入 Reminder-Cron 服务 → **Settings** → **Build**

- [ ] **Builder**：选择 **"Dockerfile"**
- [ ] **Dockerfile Path**：填写 `Dockerfile`
- [ ] **Metal Build Environment**：可以开启 ✅

#### Deploy 设置（关键）

进入 Reminder-Cron 服务 → **Settings** → **Deploy**

- [ ] **Custom Start Command**：填写
  ```
  cd backend && python3 reminder_system.py
  ```
- [ ] **Cron Schedule**：找到 **"Cron Schedule"** 部分
  - 点击 **"Add Schedule"** 或直接在输入框中输入
  - 输入：`0 14 * * *`
    - 这表示每天 UTC 14:00（马来西亚时间 22:00）执行
  - 保存

**⚠️ 重要**：
- Cron 是绑定服务的 Start Command 来运行的
- 不是项目级别的独立 "Cron Job" 任务（这是旧做法）
- 命令由该服务自身的 Start Command 控制

#### Variables 设置

进入 Reminder-Cron 服务 → **Variables**

**添加以下变量**（与 Web 服务相同）：

| Name | Value |
|------|-------|
| `DATABASE_URL` | `${{ Postgres.DATABASE_URL }}` ⚠️ **关键** |
| `SENDER_EMAIL` | `business@infinite-gz.com` |
| `SENDER_PASSWORD` | `grqcgnrwqhbeocox` |
| `RECIPIENT_EMAIL` | `wang041396@gmail.com` |
| `SMTP_SERVER` | `smtp.gmail.com` |
| `SMTP_PORT` | `587` |
| `UPLOAD_DIR` | `/app/uploads` |
| `REPORTS_DIR` | `/app/reports` |

**⚠️ 注意事项**：
- 所有变量必须与 Web 服务相同
- `DATABASE_URL` 格式必须是 `${{ Postgres.DATABASE_URL }}`

#### Volume 挂载（如果需要）

如果 `reminder_system.py` 需要读取/写入文件：

1. 进入 Reminder-Cron 服务 → **Settings** → **Volumes**
2. 点击 **"Attach Volume"**
3. 选择 `reports` Volume（用于保存生成的 Excel 报告）
4. 确认 **Mount Path** 是 `/app/reports`
5. 点击 **"Attach"**

---

## 三、环境变量配置

### 3.1 必需环境变量列表

#### Web 服务和 Reminder-Cron 服务都需要：

| 变量名 | 示例值 | 必需 | 说明 |
|--------|--------|------|------|
| `DATABASE_URL` | `${{ Postgres.DATABASE_URL }}` | ✅ | 数据库连接 |
| `SENDER_EMAIL` | `business@infinite-gz.com` | ✅ | 发件人邮箱 |
| `SENDER_PASSWORD` | `grqcgnrwqhbeocox` | ✅ | Gmail 应用密码 |
| `RECIPIENT_EMAIL` | `wang041396@gmail.com` | ✅ | 收件人邮箱 |
| `SMTP_SERVER` | `smtp.gmail.com` | ✅ | SMTP 服务器 |
| `SMTP_PORT` | `587` | ✅ | SMTP 端口 |
| `UPLOAD_DIR` | `/app/uploads` | ✅ | 上传目录 |
| `REPORTS_DIR` | `/app/reports` | ✅ | 报告目录 |

### 3.2 环境变量设置注意事项

#### DATABASE_URL
- ⚠️ **格式**：必须是 `${{ Postgres.DATABASE_URL }}`（双大括号，有空格）
- ⚠️ **服务名称**：`Postgres` 是你的数据库服务名称（如果不同，请替换）
- ⚠️ **不要手动写死**：不要使用 `postgresql://user:pass@host/db` 这样的格式

#### SENDER_PASSWORD
- ⚠️ **必须是应用密码**：不是 Gmail 账户的普通密码
- ⚠️ **如何获取**：
  1. 登录 Google 账户
  2. 进入"安全性" → "两步验证"
  3. 在底部找到"应用密码"
  4. 生成新的应用密码
  5. 复制并保存（只显示一次）

#### 路径变量
- ⚠️ **必须与 Volume Mount Path 一致**：
  - `UPLOAD_DIR` = `/app/uploads`
  - `REPORTS_DIR` = `/app/reports`
- ⚠️ **不要使用相对路径**：如 `./uploads` 或 `backend/uploads`

### 3.3 环境变量验证

#### 在 Railway Shell 中验证

1. 进入 Web 服务 → **Shell** 或 **Terminal**
2. 执行：
   ```bash
   echo $DATABASE_URL
   echo $SENDER_EMAIL
   echo $UPLOAD_DIR
   echo $REPORTS_DIR
   ```
3. **预期结果**：
   - `DATABASE_URL` 显示 PostgreSQL 连接字符串（以 `postgresql://` 开头）
   - 其他变量显示正确的值

---

## 四、运行时注意事项

### 4.1 首次部署后检查

#### 部署日志检查

1. 进入 Web 服务 → **Deployments** → 最新部署 → **Logs**
2. **应该看到**：
   ```
   ============================================================
   CreditPilot 启动中...
   ============================================================
   ✅ DATABASE_URL 已设置
   ============================================================
   初始化数据库...
   ============================================================
   📊 数据库连接: postgresql://***@...
   🔨 创建数据库表...
   ✅ 数据库表创建成功
   ✅ 数据库初始化完成
   ============================================================
   启动API服务器...
   ============================================================
   INFO:     Started server process
   INFO:     Uvicorn running on http://0.0.0.0:8000
   ```

#### 数据库初始化测试

1. 进入 Web 服务 → **Shell**
2. 执行：
   ```bash
   cd backend && python3 init_db.py
   ```
3. **预期结果**：
   - ✅ 无错误
   - ✅ 显示 "✅ 数据库初始化完成"

**如果失败**：
- 检查 `DATABASE_URL` 变量格式
- 检查 Postgres 服务是否正在运行
- 查看错误信息

#### Web 服务健康检查

1. 获取 Web 服务的公共 URL
   - 在 Web 服务 → **Networking** → **Public Networking**
2. 访问健康检查端点：
   ```bash
   curl https://your-app.railway.app/health
   ```
   或直接在浏览器访问：
   ```
   https://your-app.railway.app/health
   ```
3. **预期结果**：
   - ✅ 返回 `{"status": "healthy"}` 或类似 JSON
   - ✅ HTTP 状态码 200

---

### 4.2 日常运行注意事项

#### 数据库连接

- ⚠️ **连接池**：代码中已配置连接池（`pool_pre_ping=True`, `pool_recycle=300`）
- ⚠️ **连接超时**：如果长时间无活动，连接可能超时，但会自动重连
- ⚠️ **不要手动关闭连接**：SQLAlchemy 会自动管理连接

#### 文件上传

- ⚠️ **文件大小限制**：默认 FastAPI 限制为 100MB，如需修改，在 `main.py` 中调整
- ⚠️ **文件类型**：确保只上传 PDF 和图片文件
- ⚠️ **存储位置**：文件存储在 `/app/uploads` Volume 中，持久化保存

#### 报告生成

- ⚠️ **Excel 报告**：每天 UTC 14:00 自动生成
- ⚠️ **存储位置**：报告存储在 `/app/reports` Volume 中
- ⚠️ **邮件发送**：报告会通过邮件发送到 `RECIPIENT_EMAIL`

#### Cron 任务执行

- ⚠️ **执行时间**：每天 UTC 14:00（马来西亚时间 22:00）
- ⚠️ **执行日志**：在 Reminder-Cron 服务 → **Logs** 中查看
- ⚠️ **执行失败**：如果失败，检查日志中的错误信息

---

### 4.3 运行时监控

#### 监控指标

- [ ] **Web 服务状态**：定期检查服务是否正常运行
- [ ] **数据库连接**：定期检查数据库连接是否正常
- [ ] **Cron 任务执行**：每天检查 Cron 任务是否成功执行
- [ ] **邮件发送**：每天检查邮件是否成功发送
- [ ] **文件存储**：定期检查 Volume 存储空间

#### 日志查看

**Web 服务日志**：
- 进入 Web 服务 → **Logs**
- 查看应用运行日志
- 查找错误和警告信息

**Reminder-Cron 服务日志**：
- 进入 Reminder-Cron 服务 → **Logs**
- 查看 Cron 任务执行日志
- 查找执行失败的原因

**部署日志**：
- 进入服务 → **Deployments** → 选择部署 → **Logs**
- 查看部署过程中的日志
- 查找构建和启动错误

---

## 五、维护和监控

### 5.1 定期维护任务

#### 每日检查
- [ ] 检查 Web 服务是否正常运行
- [ ] 检查 Cron 任务是否成功执行
- [ ] 检查邮件是否成功发送
- [ ] 查看日志中是否有错误

#### 每周检查
- [ ] 检查数据库连接是否正常
- [ ] 检查 Volume 存储空间
- [ ] 检查部署日志
- [ ] 检查环境变量是否正确

#### 每月检查
- [ ] 检查数据库大小
- [ ] 检查 Volume 使用情况
- [ ] 检查 Railway 使用量
- [ ] 更新依赖（如果需要）

---

### 5.2 日志管理

#### 日志位置

**Railway 日志**：
- Web 服务 → **Logs**
- Reminder-Cron 服务 → **Logs**
- 部署日志 → **Deployments** → 选择部署 → **Logs**

**应用日志**：
- 如果代码中有日志文件，存储在 `/app/logs`（需要创建 Volume）

#### 日志级别

- **INFO**：正常操作信息
- **WARNING**：警告信息（不影响运行）
- **ERROR**：错误信息（需要关注）
- **CRITICAL**：严重错误（需要立即处理）

---

### 5.3 性能监控

#### 监控指标

- **响应时间**：API 响应时间
- **数据库查询时间**：数据库查询性能
- **文件上传速度**：文件上传性能
- **Cron 任务执行时间**：Cron 任务执行耗时

#### 性能优化建议

- **数据库索引**：确保数据库表有适当的索引
- **连接池**：已配置连接池，不要修改
- **文件缓存**：如果文件较大，考虑添加缓存
- **异步处理**：大文件处理可以考虑异步

---

## 六、安全注意事项

### 6.1 环境变量安全

#### 敏感信息保护

- ⚠️ **不要提交到 Git**：`.env` 文件应在 `.gitignore` 中
- ⚠️ **使用 Railway Variables**：敏感信息存储在 Railway Variables 中
- ⚠️ **定期轮换密码**：定期更换 Gmail 应用密码
- ⚠️ **限制访问**：只给需要的人访问权限

#### 密码管理

- ⚠️ **Gmail 应用密码**：使用应用密码，不是账户密码
- ⚠️ **数据库密码**：Railway 自动管理，不要手动设置
- ⚠️ **不要硬编码**：不要在代码中硬编码密码

---

### 6.2 API 安全

#### CORS 配置

当前配置：
```python
allow_origins=["*"]  # 生产环境应限制具体域名
```

**⚠️ 生产环境建议**：
- 限制 `allow_origins` 为具体的域名
- 例如：`allow_origins=["https://your-domain.com"]`

#### 文件上传安全

- ⚠️ **文件类型验证**：确保只接受 PDF 和图片文件
- ⚠️ **文件大小限制**：限制文件大小
- ⚠️ **文件名验证**：验证文件名，防止路径遍历攻击

---

### 6.3 数据库安全

#### 连接安全

- ⚠️ **使用 SSL**：Railway PostgreSQL 默认使用 SSL
- ⚠️ **不要暴露连接字符串**：不要在日志中打印完整的连接字符串
- ⚠️ **定期备份**：定期备份数据库

---

## 七、性能优化

### 7.1 数据库优化

#### 索引优化

- [ ] 确保常用查询字段有索引
- [ ] 定期分析查询性能
- [ ] 优化慢查询

#### 连接池配置

当前配置（已优化）：
```python
pool_pre_ping=True,  # 连接前检查连接是否有效
pool_recycle=300,    # 回收连接时间（秒）
```

**不要修改**：这些配置已经优化过。

---

### 7.2 应用优化

#### 代码优化

- [ ] 使用异步处理大文件
- [ ] 缓存常用数据
- [ ] 优化数据库查询

#### 资源限制

- [ ] 监控 Railway 资源使用
- [ ] 根据需要调整资源限制
- [ ] 优化内存使用

---

## 八、故障排查

### 8.1 常见问题

#### 问题 1：数据库连接失败

**症状**：
```
✗ 数据库初始化失败: could not connect to server
```

**排查步骤**：
1. 检查 `DATABASE_URL` 变量格式：`${{ Postgres.DATABASE_URL }}`
2. 检查 Postgres 服务是否正在运行
3. 检查服务名称是否正确（区分大小写）
4. 查看详细错误信息

**解决方案**：
- 重新设置 `DATABASE_URL` 变量
- 确认 Postgres 服务正在运行
- 检查网络连接

---

#### 问题 2：端口错误

**症状**：
```
Address already in use
或
Port 8000 is not available
```

**排查步骤**：
1. 检查 Networking → Port = `8000`
2. 检查代码中端口配置
3. 检查启动脚本

**解决方案**：
- 确认端口配置一致
- 重新部署服务

---

#### 问题 3：路径错误

**症状**：
```
No such file or directory: /app/uploads
```

**排查步骤**：
1. 检查 Volume 是否已创建
2. 检查 Volume 是否已附加到服务
3. 检查 Mount Path 是否正确
4. 检查代码中的路径

**解决方案**：
- 创建 Volume（如果不存在）
- 附加 Volume 到服务
- 确认路径一致

---

#### 问题 4：Cron 不执行

**症状**：
- Cron 任务不运行
- 邮件未发送

**排查步骤**：
1. 检查 Cron Schedule 格式：`0 14 * * *`
2. 检查 Start Command：`cd backend && python3 reminder_system.py`
3. 检查所有环境变量是否设置
4. 查看 Reminder-Cron 服务日志

**解决方案**：
- 确认 Cron Schedule 格式正确
- 确认 Start Command 正确
- 设置所有必需的环境变量

---

#### 问题 5：邮件发送失败

**症状**：
- Cron 执行但邮件未发送
- 显示 SMTP 错误

**排查步骤**：
1. 检查 `SENDER_EMAIL` 是否正确
2. 检查 `SENDER_PASSWORD` 是否正确（Gmail 应用密码）
3. 检查 `SMTP_SERVER` = `smtp.gmail.com`
4. 检查 `SMTP_PORT` = `587`
5. 检查 `RECIPIENT_EMAIL` 是否正确
6. 查看日志中的错误信息

**解决方案**：
- 确认所有邮件相关变量
- 检查 Gmail 应用密码是否有效
- 检查 Gmail 账户是否启用了"允许不够安全的应用"

---

### 8.2 诊断命令

#### 在 Railway Shell 中执行

**检查环境变量**：
```bash
echo $DATABASE_URL
echo $PORT
echo $UPLOAD_DIR
echo $REPORTS_DIR
```

**测试数据库连接**：
```bash
cd backend
python3 init_db.py
```

**检查文件路径**：
```bash
ls -la /app/uploads
ls -la /app/reports
```

**检查 Python 模块**：
```bash
cd backend
python3 -c "from models import Base, engine; print('✅ 模块导入成功')"
```

---

## 九、备份和恢复

### 9.1 数据库备份

#### Railway PostgreSQL 备份

Railway 提供自动备份功能：
- [ ] 启用自动备份（在 Postgres 服务设置中）
- [ ] 设置备份频率
- [ ] 测试备份恢复

#### 手动备份

如果需要手动备份：
1. 使用 `pg_dump` 工具
2. 导出数据库到文件
3. 存储备份文件

---

### 9.2 文件备份

#### Volume 备份

- [ ] 定期备份 `/app/uploads` Volume
- [ ] 定期备份 `/app/reports` Volume
- [ ] 测试备份恢复

---

### 9.3 恢复流程

#### 数据库恢复

1. 从备份文件恢复数据库
2. 验证数据完整性
3. 测试应用功能

#### 文件恢复

1. 从备份恢复文件
2. 验证文件完整性
3. 测试文件访问

---

## 十、常见问题

### 10.1 设置问题

#### Q: DATABASE_URL 格式是什么？
**A**: `${{ Postgres.DATABASE_URL }}`（双大括号，有空格）

#### Q: 如何获取 Gmail 应用密码？
**A**: 
1. 登录 Google 账户
2. 进入"安全性" → "两步验证"
3. 在底部找到"应用密码"
4. 生成新的应用密码

#### Q: Volume 在哪里创建？
**A**: 在项目主页（不是服务页面），点击 "+Create" → "VOLUME"

---

### 10.2 运行时问题

#### Q: Cron 任务不执行怎么办？
**A**: 
1. 检查 Cron Schedule 格式：`0 14 * * *`
2. 检查 Start Command 是否正确
3. 查看 Reminder-Cron 服务日志

#### Q: 邮件发送失败怎么办？
**A**: 
1. 检查所有邮件相关环境变量
2. 确认 Gmail 应用密码有效
3. 查看日志中的错误信息

#### Q: 文件上传失败怎么办？
**A**: 
1. 检查 Volume 是否已挂载
2. 检查路径是否正确
3. 检查文件大小限制

---

### 10.3 维护问题

#### Q: 如何查看日志？
**A**: 在 Railway 服务页面 → **Logs**

#### Q: 如何重新部署？
**A**: 在 Railway 服务页面 → **Deployments** → **Redeploy**

#### Q: 如何更新代码？
**A**: 
1. 推送代码到 GitHub
2. Railway 会自动检测并部署
3. 或手动触发重新部署

---

## 📋 完整检查清单

### 初始设置
- [ ] 所有代码文件存在
- [ ] 代码已推送到 GitHub
- [ ] Railway 项目已创建

### Railway 配置
- [ ] Postgres 服务已创建
- [ ] Web 服务已创建
- [ ] Reminder-Cron 服务已创建（方案B）
- [ ] Volume 已创建并挂载
- [ ] 所有环境变量已设置

### 验证测试
- [ ] 数据库连接测试通过
- [ ] Web 服务健康检查通过
- [ ] Cron 任务执行成功
- [ ] 邮件发送成功

---

## ✅ 完成！

如果所有检查都通过，你的 CreditPilot 系统应该可以顺利运行！

**最后更新**：2025-12-10  
**文档版本**：1.0
