# 📎 单据上传功能使用说明

## ✅ 功能已实现！

小助理现在可以通过以下方式上传单据：

1. **Merchant Receipt（刷卡收据）**
2. **Payment Receipt（付款单）**
3. **Transfer Slip（转账单）**

---

## 🚀 如何使用

### 方法1：通过API文档（最简单）⭐

1. **打开浏览器**，访问：`http://localhost:8000/docs`

2. **找到** `POST /api/documents/upload` 这个API端点

3. **点击 "Try it out"**

4. **填写参数：**
   - **file**: 点击 "Choose File"，选择单据图片或PDF
   - **statement_id**: （可选）账单ID，如果知道是哪个账单的单据，填入账单ID
   - **document_type**: （可选）单据类型，选择：
     - `Merchant Slip` - 刷卡收据
     - `Payment Receipt` - 付款单
     - `Transfer Slip` - 转账单
     - `Statement` - 账单（默认）

5. **点击 "Execute"**（执行）

6. **查看结果**，系统会返回：
   - 单据ID
   - 单据类型
   - 关联的账单ID
   - 上传日期

---

### 方法2：通过命令行

```bash
curl -X POST "http://localhost:8000/api/documents/upload" \
  -F "file=@/path/to/receipt.jpg" \
  -F "statement_id=1" \
  -F "document_type=Merchant Slip"
```

---

## 📋 支持的格式

- **图片：** JPG, JPEG, PNG, GIF
- **PDF：** PDF文件

---

## 🔗 关联账单

### 方式1：上传时关联

在上传单据时，填写 `statement_id` 参数，系统会自动关联到对应的账单。

### 方式2：后续关联

如果上传时不知道账单ID，可以：
1. 先上传单据（不填 statement_id）
2. 查看账单列表，找到对应的账单ID
3. 通过API更新单据的 statement_id（需要添加这个功能）

---

## 📊 查看单据

### 查看所有单据

访问：`http://localhost:8000/api/documents`

或通过API文档：`GET /api/documents`

**可以筛选：**
- 按账单ID：`?statement_id=1`
- 按单据类型：`?document_type=Merchant Slip`

### 查看单个单据

访问：`http://localhost:8000/api/documents/{document_id}`

### 下载单据

访问：`http://localhost:8000/api/documents/{document_id}/download`

---

## 📱 未来iPad App功能

等iPad App开发完成后，小助理可以：
- 📸 直接拍照上传单据
- 📁 从相册选择图片上传
- 🔗 自动关联到对应的账单
- 👁️ 在账单详情页面查看所有单据

---

## 🎯 使用场景示例

### 场景1：上传刷卡收据

1. 小助理收到客户的刷卡收据（照片）
2. 打开浏览器，访问 `http://localhost:8000/docs`
3. 找到 `POST /api/documents/upload`
4. 选择收据照片
5. 选择单据类型：`Merchant Slip`
6. 填写账单ID（如果知道）
7. 上传

### 场景2：上传付款单

1. 客户付款后，小助理收到付款单
2. 拍照或扫描成PDF
3. 通过API上传
4. 选择单据类型：`Payment Receipt`
5. 关联到对应的账单

### 场景3：上传转账单

1. 客户通过银行转账付款
2. 小助理收到转账单截图
3. 上传单据
4. 选择单据类型：`Transfer Slip`
5. 关联到账单

---

## ✅ 功能特点

- ✅ 支持多种文件格式（图片、PDF）
- ✅ 可以关联到账单
- ✅ 可以按类型分类
- ✅ 可以查看和下载
- ✅ 可以删除
- ✅ 记录上传日期

---

## 📝 下一步

等iPad App开发完成后，会有更便捷的上传方式：
- 拍照直接上传
- 自动识别账单
- 批量上传
- OCR识别（自动提取金额等信息）

---

**现在小助理可以通过浏览器上传单据了！** 📎✨
